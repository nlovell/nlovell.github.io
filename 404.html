<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>404 Not Found</title>
  </head>
  <body>
    <script>
      window.onload = () => {
        const url = new URL(window.location.href);

        // Check if already redirected
        if (url.searchParams.get('lcr') === 'true') {
          // Show a basic 404 message
          document.body.innerHTML = '<h1>404 - Page Not Found</h1><p>The page could not be found.</p>';
          return;
        }

        // Generate lowercase version of full URL (path + search + hash)
        const lowerHref = (
          url.origin + url.pathname.toLowerCase() +
          url.search.toLowerCase() +
          url.hash.toLowerCase()
        );

        // Append the lcr flag
        const separator = lowerHref.includes('?') ? '&' : '?';
        const redirectURL = `${lowerHref}${separator}lcr=true`;

        // Only redirect if the current URL is not already lowercase
        if (window.location.href !== redirectURL) {
          window.location.replace(redirectURL);
        } else {
          // If somehow already lowercased and still 404, show fallback
          document.body.innerHTML = '<h1>404 - Page Not Found</h1><p>The page could not be found.</p>';
        }
      };
    </script>
  </body>
</html>
